# 变量
## 声明和引用
``` powershell
$a=1
echo $a
```
powershell中，凡是变量，无论声明还是引用，均以`$`开头。

# 参数
```PowerShell
Param(
	$firstParam,
	$secondParam
)
```
参数可分为**脚本参数**、**函数参数**。脚本参数在脚本全局范围声明，函数参数在函数体中声明。

## 脚本参数
在调用脚本传参时，智能使用短参数语法`-`，传参方式为`-param value`，其中，`-param`可以不用给全，仅需要首位字母匹配即可。

处理上述关键字传参，还可以按照参数位置进行位置传参。

# 函数
```PowerShell
function functionName{
	param(
		[string]$firstParam,
		[string[]]$secondParam
	)
	...
}
```
参数不在原括弧中声明，而是通过`Param`声明。

# 读取XML作为配置文件
```PowerShell
# 读取
[xml]$config = cat file.xml
# 访问
echo $config.root.name
```
![空格](XML.md#空格)


# 运算符
##  逻辑运算符
逻辑运算符用于计算布尔表达式，它们主要用于条件语句和循环语句中。
- **-and**：逻辑与。当两个表达式都为真时，返回 `$True`。
  ```powershell
  $true -and $false  # 返回 $False
  ```
- **-or**：逻辑或。当任一表达式为真时，返回 `$True`。
  ```powershell
  $true -or $false   # 返回 $True
  ```
- **-not** 或 **!**：逻辑非。将布尔值取反。
  ```powershell
  -not $true  # 返回 $False
  !($true)    # 返回 $False
  ```
- **-xor**：逻辑异或。当且仅当两个表达式中有一个为真时，返回 `$True`。
  ```powershell
  $true -xor $false  # 返回 $True
  ```

## 比较运算符
比较运算符用于比较两个值，返回布尔结果（`$True` 或 `$False`）。
- **-eq**：等于（equals）。
  ```powershell
  5 -eq 5    # 返回 $True
  "abc" -eq "abc"  # 返回 $True
  ```
- **-ne**：不等于（not equals）。
  ```powershell
  5 -ne 3    # 返回 $True
  ```
- **-gt**：大于（greater than）。
  ```powershell
  10 -gt 5   # 返回 $True
  ```
- **-ge**：大于等于（greater than or equal to）。
  ```powershell
  10 -ge 10  # 返回 $True
  ```
- **-lt**：小于（less than）。
  ```powershell
  3 -lt 5    # 返回 $True
  ```
- **-le**：小于等于（less than or equal to）。
  ```powershell
  5 -le 5    # 返回 $True
  ```
- **-like**：模式匹配（使用通配符 `*`）。
  ```powershell
  "hello" -like "h*"  # 返回 $True
  ```
- **-notlike**：不匹配模式。
  ```powershell
  "hello" -notlike "w*"  # 返回 $True
  ```
- **-match**：正则表达式匹配。
  ```powershell
  "hello" -match "h.*o"  # 返回 $True
  ```
- **-notmatch**：正则表达式不匹配。
  ```powershell
  "hello" -notmatch "h.*o"  # 返回 $False
  ```
- **-contains**：检查集合是否包含某个值。
  ```powershell
  1, 2, 3 -contains 2  # 返回 $True
  ```
- **-notcontains**：检查集合不包含某个值。
  ```powershell
  1, 2, 3 -notcontains 4  # 返回 $True
  ```
- **-in**：检查某个值是否存在于集合中（和 `-contains` 相反）。
  ```powershell
  2 -in 1, 2, 3  # 返回 $True
  ```
- **-notin**：检查某个值是否不存在于集合中（和 `-notcontains` 相反）。
  ```powershell
  4 -notin 1, 2, 3  # 返回 $True
  ```
- **-is**：类型比较，检查对象是否属于特定类型。
  ```powershell
  "hello" -is [string]  # 返回 $True
  ```
- **-isnot**：检查对象不属于特定类型。
  ```powershell
  5 -isnot [string]  # 返回 $True
  ```

## 算术运算符
算术运算符用于执行数学运算。
- **+**：加法。
  ```powershell
  5 + 3  # 返回 8
  ```
- **-**：减法。
  ```powershell
  5 - 3  # 返回 2
  ```
- **\***：乘法。
  ```powershell
  5 * 3  # 返回 15
  ```
- **/**：除法。
  ```powershell
  6 / 2  # 返回 3
  ```
- **%**：取模（求余）。
  ```powershell
  5 % 2  # 返回 1
  ```
- **++**：自增运算符。
  ```powershell
  $a = 5
  $a++   # $a 变为 6
  ```
- **--**：自减运算符。
  ```powershell
  $a = 5
  $a--   # $a 变为 4
  ```

## 赋值运算符
赋值运算符用于将一个值分配给一个变量。
- **=**：赋值。
  ```powershell
  $a = 5  # 将 5 赋值给变量 $a
  ```
- **+=**：加法赋值。
  ```powershell
  $a += 3  # 等同于 $a = $a + 3
  ```
- **-=**：减法赋值。
  ```powershell
  $a -= 2  # 等同于 $a = $a - 2
  ```
- **\*=**：乘法赋值。
  ```powershell
  $a *= 2  # 等同于 $a = $a * 2
  ```
- **/=**：除法赋值。
  ```powershell
  $a /= 2  # 等同于 $a = $a / 2
  ```
- **%=**：取模赋值。
  ```powershell
  $a %= 3  # 等同于 $a = $a % 3
  ```

## 特殊运算符
特殊运算符包括各种独特的运算符，用于执行其他操作。
- **.（点）**：调用对象的成员（方法或属性）。
  ```powershell
  $obj.Property  # 访问对象属性
  ```
- **&（调用运算符）**：执行字符串或脚本块作为命令。
  ```powershell
  & "C:\path\to\script.ps1"
  ```
- **..（范围运算符）**：创建一个整数范围。
  ```powershell
  1..5  # 生成 1 到 5 的范围
  
  # a..b => [a,b]
  ```
- **,（逗号）**：创建数组。
  ```powershell
  $array = 1, 2, 3
  ```
- **;（分号）**：用于在单行中分隔多条语句。
  ```powershell
  $a = 5; $b = 6
  ```
- **?（Where-Object 别名）**：用于过滤集合。
  ```powershell
  1..5 | ? { $_ -gt 3 }  # 返回大于 3 的数
  ```
- **%（ForEach-Object 别名）**：用于对集合中的每个元素执行操作。
  ```powershell
  1..3 | % { $_ * 2 }  # 每个元素乘以 2
  ```

## 类型转换运算符
用于将值转换为指定的类型。
- **\[type]**：强制转换类型。
  ```powershell
  [int]"5.5"  # 转换为整数，结果为 6, 四舍五入
  ```
  

# 控制流
## for循环
```PowerShell
for ($i = 0; $i -lt 10; $i++){
	echo $i
}
```

## for-each 循环
```PowerShell
$array = @("item1", "item2", "item3")
 
foreach ($element in $array) { $element }
 
$array | foreach { $_ }
```

## while 循环
```PowerShell
$array = @("item1", "item2", "item3")
$counter = 0;

while($counter -lt $array.length){
   $array[$counter]
   $counter += 1
}
```

## do-while 循环
```PowerShell
do {
   $array[$counter]
   $counter += 1
} while($counter -lt $array.length)
```

## if-elseif-else
```PowerShell
if(Boolean_expression 1) {
   // Executes when the Boolean expression 1 is true
}elseif(Boolean_expression 2) {
   // Executes when the Boolean expression 2 is true
}elseif(Boolean_expression 3) {
   // Executes when the Boolean expression 3 is true
}else {
   // Executes when the none of the above condition is true.
}
```

# 数组
## 开辟数组空间
```PowerShell
# 使用数组字面量，手动指定值
$arr = 1, 2, 3

# 使用范围运算符 ..
$arr = 1..10

# 使用 @ 运算符
$a = $null
$b = 12
$c = 34
$arr = @($a, $b, $c)
# $arr => [12, 34]
```

>[!note]- 
>在PowerShell中，开辟数组空间时必须初始化，无法开辟没有初始化的数组。

`@` 运算符将若干变量装入数组中，当某个变量为`$null`时，也会为其分配空间。

